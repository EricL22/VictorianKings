namespace = colonization

## Colonization begin notification
# Influx of settlers
colonization.1 = {
	type = character_event
	title = colonization.1.name
	desc = colonization.1.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = root
		animation = idle
	}

	trigger = {
	}

	immediate = {
	}
	
	option = {
		name = name_i_see
	}
}
## Colonization success
# Notification message
colonization.9 = {
	type = character_event
	title = colonization.10.name
	desc = colonization.9.desc
	theme = realm
	left_portrait = {
		character = root
		animation = idle
	}
	right_portrait = {
		character = scope:the_colonized
		animation = idle
	}

	trigger = {
	}

	immediate = {
	}
	
	option = {
		name = colonization.9.a
	}
}
# Handles title switching and notification
colonization.10 = {
	type = character_event
	title = colonization.10.name
	desc = colonization.10.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = root
		animation = idle
	}

	trigger = {
	}

	immediate = {
		remove_list_global_variable = {
			name = involved_in_colonization
			target = root
		}
	}
	
	option = {
		name = colonization.10.a
		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
			add_claim_on_loss = yes
		}
		every_realm_county = {
			limit = { is_in_list = conquest_colonies }
			change_title_holder = {
				holder = scope:colonizer_title.holder
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change
		save_scope_as = the_colonized
		scope:colonizer_title.holder = { trigger_event = colonization.9 }
	}
}

## Actor events
# Resource Deposit Found
colonization.11 = {
	type = character_event
	title = colonization.11.name
	desc = colonization.11.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = colonize_target
		}
		set_variable = { name = progress_change value = 1 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.11.a
		add_gold = major_gold_value
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# (from 101)
colonization.12 = {
	type = character_event
	title = colonization.12.name
	desc = colonization.12.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		set_variable = { name = progress_change value = -1 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.12.a
		add_piety = -250
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# (from 101)
colonization.13 = {
	type = character_event
	title = colonization.13.name
	desc = colonization.13.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		set_variable = { name = progress_change value = 2 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.13.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# (from 102)
colonization.14 = {
	type = character_event
	title = colonization.14.name
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_flag = settlement_attack
				}
				desc = colonization.14.desc.2
			}
			desc = colonization.14.desc
		}
	}
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		random = {
			chance = 33
			add_character_flag = settlement_attack
		}
		set_variable = { name = progress_change value = -2 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.14.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# Language Acceptance
colonization.15 = {
	type = character_event
	title = colonization.15.name
	desc = colonization.15.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
		NOT = { has_character_flag = colonization_culture_rejected }
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = colonize_target
		}
		set_variable = { name = progress_change value = 1 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.15.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# Rejected Language
colonization.16 = {
	type = character_event
	title = colonization.16.name
	desc = colonization.16.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
		NOT = { has_character_flag = colonization_culture_embraced }
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = colonize_target
		}
		set_variable = { name = progress_change value = -2 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.16.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# Built Infrastructure
colonization.17 = {
	type = character_event
	title = colonization.17.name
	desc = colonization.17.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = colonize_target
		}
		set_variable = { name = progress_change value = 1 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.17.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# No Local Guides
colonization.18 = {
	type = character_event
	title = colonization.18.name
	desc = colonization.18.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = colonize_target
		}
		set_variable = { name = progress_change value = -1 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.18.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# Volunteer Guide
colonization.19 = {
	type = character_event
	title = colonization.19.name
	desc = colonization.19.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = colonize_target
		}
		set_variable = { name = progress_change value = 1 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.19.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# Native Citizens
colonization.20 = {
	type = character_event
	title = colonization.20.name
	desc = colonization.20.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = colonize_target
		}
		set_variable = { name = progress_change value = 1 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.20.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# Industrialization
colonization.24 = {
	type = character_event
	title = colonization.24.name
	desc = colonization.24.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
		culture = { has_cultural_era_or_later = culture_era_industrial }
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = colonize_target
		}
		set_variable = { name = progress_change value = 2 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.24.a
		add_gold = -1000
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
	option = {
		name = colonization.24.b
		set_variable = { name = progress_change value = 0 }
	}
}
# Priority in Agriculture
colonization.25 = {
	type = character_event
	title = colonization.25.name
	desc = colonization.25.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = colonize_target
		}
		set_variable = { name = progress_change value = 1 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.25.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# (from 103)
colonization.26 = {
	type = character_event
	title = colonization.26.name
	desc = colonization.26.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		set_variable = { name = progress_change value = 2 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.26.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# (from 103)
colonization.27 = {
	type = character_event
	title = colonization.27.name
	desc = colonization.27.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		set_variable = { name = progress_change value = 1 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.27.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# (from 103)
colonization.28 = {
	type = character_event
	title = colonization.28.name
	desc = colonization.28.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		set_variable = { name = progress_change value = -1 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.28.a
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
}
# Educational Funding
colonization.30 = {
	type = character_event
	title = colonization.30.name
	desc = colonization.30.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = scope:colonize_target
		animation = idle
	}

	trigger = {
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = colonize_target
		}
		set_variable = { name = progress_change value = 1 }
		save_scope_as = root_loc
	}
	
	option = {
		name = colonization.30.a
		add_gold = -500
		custom_tooltip = {
			text = colony_progress_change_effect
		}
	}
	option = {
		name = colonization.30.b
		set_variable = { name = progress_change value = 0 }
	}
}

## Recipient events
# Missionaries Arrive
colonization.101 = {
	type = character_event
	title = colonization.101.name
	desc = colonization.101.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = root
		animation = idle
	}

	trigger = {
	}

	immediate = {
		scope:colonizer_title.holder = { faith = { save_scope_as = colonizing_faith } }
		save_scope_as = colonize_target
	}
	
	option = {
		name = colonization.101.a
		scope:colonizer_title.holder = { trigger_event = colonization.12 }
		ai_chance = {
			base = 10
		}
	}
	option = {
		name = colonization.101.b
		set_character_faith_with_conversion = scope:colonizing_faith
		scope:colonizer_title.holder = { trigger_event = colonization.13 }
		ai_chance = {
			base = 1
			modifier = {
				factor = 0
				has_trait = zealous
			}
		}
	}
}
# Infrastructure Sabotage
colonization.102 = {
	type = character_event
	title = colonization.102.name
	desc = colonization.102.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = root
		animation = idle
	}

	trigger = {
		scope:colonizer_title.holder = { NOT = { has_character_flag = settlement_attack } }
	}

	immediate = {
	}
	
	option = {
		name = colonization.102.a
		scope:colonizer_title.holder = { trigger_event = colonization.14 }
	}
	option = {
		name = colonization.102.b
	}
}
# Cultural Assimilation
colonization.103 = {
	type = character_event
	title = colonization.103.name
	desc = colonization.103.desc
	theme = realm
	left_portrait = {
		character = scope:colonizer_title.holder
		animation = idle
	}
	right_portrait = {
		character = root
		animation = idle
	}

	trigger = {
		scope:colonizer_title.holder = {
			NOR = {
				has_character_flag = colonization_culture_embraced
				has_character_flag = colonization_culture_accepted
				has_character_flag = colonization_culture_rejected
			}
		}
	}

	immediate = {
	}
	
	option = {
		name = colonization.103.a
		create_hybrid_culture = scope:colonizer_title.holder.culture
		scope:colonizer_title.holder = { trigger_event = colonization.26 }
	}
	option = {
		name = colonization.103.b
		change_cultural_acceptance = {
			target = scope:colonizer_title.holder.culture
			value = 20
			desc = cultural_acceptance_gain_colonization_accepted
		}
		scope:colonizer_title.holder = { trigger_event = colonization.27 }
	}
	option = {
		name = colonization.103.c
		change_cultural_acceptance = {
			target = scope:colonizer_title.holder.culture
			value = -20
			desc = cultural_acceptance_gain_colonization_rejected
		}
		scope:colonizer_title.holder = { trigger_event = colonization.28 }
	}
}

## Invalidation events
# Actor loses Kingdom title or is no longer independent
colonization.1000 = {
	type = character_event
	title = colonization.1000.name
	desc = colonization.1000.desc
	theme = realm
	left_portrait = {
		character = root
		animation = idle
	}
	right_portrait = {
		character = scope:col_tar
		animation = idle
	}

	trigger = {
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = col_tar
		}
	}
	
	option = {
		name = name_i_see
	}
}
# Actor becomes tribal
colonization.1001 = {
	type = character_event
	title = colonization.1000.name
	desc = colonization.1001.desc
	theme = realm
	left_portrait = {
		character = root
		animation = idle
	}
	right_portrait = {
		character = scope:col_tar
		animation = idle
	}

	trigger = {
	}

	immediate = {
		random_independent_ruler = {
			limit = { any_realm_county = { is_in_list = conquest_colonies } }
			save_scope_as = col_tar
		}
	}
	
	option = {
		name = colonization.1001.a
	}
}
# Recipient colonization cancelled notification
colonization.1002 = {
	type = character_event
	title = colonization.1000.name
	desc = colonization.1002.desc
	theme = realm
	left_portrait = {
		character = scope:previous_holder_target
		animation = idle
	}
	right_portrait = {
		character = root
		animation = idle
	}

	trigger = {
	}

	immediate = {
	}
	
	option = {
		name = name_i_see
	}
}